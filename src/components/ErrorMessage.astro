---
/**
 * Reusable error message component with retry functionality
 *
 * Usage examples:
 *   <ErrorMessage message="Failed to load data" />
 *   <ErrorMessage message="Network error" retryId="retry-btn" />
 *   <ErrorMessage variant="inline" message="Invalid input" />
 */
interface Props {
  message: string;
  class?: string;
  variant?: 'default' | 'inline' | 'toast';
  retryId?: string;
  retryLabel?: string;
}

const {
  message,
  class: className = '',
  variant = 'default',
  retryId,
  retryLabel = 'Try again',
} = Astro.props;
---

{variant === 'toast' ? (
  <div
    class:list={[
      'fixed bottom-4 right-4 max-w-md p-4 rounded-xl shadow-lg z-50',
      'bg-ctp-red/20 border border-ctp-red text-ctp-red',
      'animate-slide-up',
      className,
    ]}
    role="alert"
  >
    <div class="flex items-start gap-3">
      <svg
        class="w-5 h-5 flex-shrink-0 mt-0.5"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
        aria-hidden="true"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"
        />
      </svg>
      <div class="flex-1">
        <p class="font-medium">{message}</p>
        {retryId && (
          <button
            type="button"
            id={retryId}
            class="mt-2 text-sm text-ctp-red hover:underline focus:outline-none focus:ring-2 focus:ring-ctp-red/50 rounded"
          >
            {retryLabel}
          </button>
        )}
      </div>
    </div>
  </div>
) : variant === 'inline' ? (
  <p
    class:list={[
      'text-sm text-ctp-red flex items-center gap-1.5',
      className,
    ]}
    role="alert"
  >
    <svg
      class="w-4 h-4 flex-shrink-0"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
      stroke-width="2"
      aria-hidden="true"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"
      />
    </svg>
    {message}
  </p>
) : (
  <div
    class:list={[
      'text-center py-8 px-4',
      className,
    ]}
    role="alert"
  >
    <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-ctp-red/10 mb-4">
      <svg
        class="w-6 h-6 text-ctp-red"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
        aria-hidden="true"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"
        />
      </svg>
    </div>
    <p class="text-ctp-red font-medium mb-2">{message}</p>
    {retryId && (
      <button
        type="button"
        id={retryId}
        class="text-sm text-ctp-lavender hover:underline focus:outline-none focus:ring-2 focus:ring-ctp-lavender/50 rounded px-2 py-1"
      >
        {retryLabel}
      </button>
    )}
  </div>
)}

<style>
  @keyframes slide-up {
    from {
      opacity: 0;
      transform: translateY(1rem);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-slide-up {
    animation: slide-up 0.2s ease-out;
  }
</style>
